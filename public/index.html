<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Haunted Experience</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Inter', system-ui, -apple-system, sans-serif;
        overflow: hidden;
        background: #000;
        color: #fff;
      }

      /* ===== LANDING PAGE ===== */
      .landing-page {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
        transition: opacity 0.5s;
      }

      .landing-page.hidden {
        opacity: 0;
        pointer-events: none;
      }

      .teaser-video-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      #teaserVideo {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .teaser-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(to bottom, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0.3) 50%, rgba(0,0,0,0.7) 100%);
      }

      .landing-content {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 2;
      }

      .landing-title {
        font-size: clamp(3rem, 12vw, 7rem);
        font-weight: 900;
        text-transform: uppercase;
        letter-spacing: 0.15em;
        text-shadow: 0 0 50px rgba(139, 0, 0, 0.9), 0 0 100px rgba(139, 0, 0, 0.6);
        animation: flicker 3s infinite alternate;
        margin-bottom: 3rem;
      }

      @keyframes flicker {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.93; }
      }

      .begin-button {
        background: linear-gradient(135deg, #8B0000, #DC143C);
        border: 3px solid rgba(255, 255, 255, 0.4);
        color: #fff;
        font-size: 1.8rem;
        font-weight: 700;
        padding: 1.8rem 5rem;
        border-radius: 60px;
        cursor: pointer;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        transition: all 0.3s;
        box-shadow: 0 15px 50px rgba(139, 0, 0, 0.5);
      }

      .begin-button:hover {
        transform: translateY(-8px);
        box-shadow: 0 20px 60px rgba(139, 0, 0, 0.7);
      }

      /* ===== WIZARD MODAL ===== */
      .wizard-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        z-index: 100;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 20px;
        animation: fadeIn 0.3s;
      }

      .wizard-modal.active {
        display: flex;
      }

      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      .wizard-container {
        max-width: 600px;
        width: 100%;
        background: rgba(20, 20, 20, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        overflow: hidden;
        animation: slideUp 0.4s;
      }

      @keyframes slideUp {
        from { transform: translateY(50px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }

      .progress-bar {
        height: 6px;
        background: rgba(255, 255, 255, 0.1);
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #8B0000, #DC143C);
        transition: width 0.4s;
        box-shadow: 0 0 20px rgba(220, 20, 60, 0.5);
      }

      .wizard-header {
        padding: 2rem 2.5rem 1rem;
        text-align: center;
      }

      .step-counter {
        font-size: 0.9rem;
        color: #DC143C;
        font-weight: 700;
        letter-spacing: 0.15em;
        text-transform: uppercase;
        margin-bottom: 0.5rem;
      }

      .step-title {
        font-size: 1.8rem;
        font-weight: 800;
        color: #fff;
      }

      .wizard-content {
        padding: 1.5rem 2.5rem 2rem;
        min-height: 320px;
      }

      .step {
        display: none;
      }

      .step.active {
        display: block;
        animation: stepFadeIn 0.4s;
      }

      @keyframes stepFadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }

      .instruction-list {
        list-style: none;
        margin: 1.5rem 0;
      }

      .instruction-list li {
        padding: 0.8rem 0 0.8rem 2rem;
        position: relative;
        color: rgba(255, 255, 255, 0.85);
        line-height: 1.6;
      }

      .instruction-list li::before {
        content: '→';
        position: absolute;
        left: 0;
        color: #DC143C;
        font-weight: bold;
      }

      .sensor-grid {
        display: grid;
        gap: 1rem;
        margin: 1.5rem 0;
      }

      .sensor-card {
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 1.2rem;
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .sensor-icon {
        font-size: 2.5rem;
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 50%;
      }

      .sensor-name {
        font-size: 1.2rem;
        font-weight: 700;
      }

      .info-box {
        background: rgba(220, 20, 60, 0.1);
        border-left: 4px solid #DC143C;
        padding: 1.2rem;
        border-radius: 8px;
        margin: 1.5rem 0;
        line-height: 1.6;
      }

      .info-box strong {
        color: #DC143C;
        display: block;
        margin-bottom: 0.5rem;
      }

      .example {
        font-style: italic;
        color: rgba(255, 255, 255, 0.7);
        margin-top: 0.5rem;
        font-size: 0.95rem;
      }

      .success-icon {
        font-size: 5rem;
        text-align: center;
        margin: 1rem 0;
        animation: bounceIn 0.6s;
      }

      @keyframes bounceIn {
        0% { transform: scale(0); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
      }

      .success-message {
        text-align: center;
        font-size: 1.1rem;
        line-height: 1.8;
        color: rgba(255, 255, 255, 0.9);
        margin: 1.5rem 0;
      }

      .wizard-nav {
        padding: 1.5rem 2.5rem 2rem;
        display: flex;
        gap: 1rem;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      .nav-btn {
        flex: 1;
        padding: 1rem 2rem;
        border: none;
        border-radius: 12px;
        font-size: 1rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .btn-back {
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .btn-back:hover {
        background: rgba(255, 255, 255, 0.15);
      }

      .btn-back:disabled {
        opacity: 0.3;
        cursor: not-allowed;
      }

      .btn-next {
        background: linear-gradient(135deg, #8B0000, #DC143C);
        color: #fff;
        box-shadow: 0 5px 20px rgba(220, 20, 60, 0.3);
      }

      .btn-next:hover {
        box-shadow: 0 7px 25px rgba(220, 20, 60, 0.5);
      }

      .btn-complete {
        background: linear-gradient(135deg, #228B22, #32CD32);
      }

      /* ===== MAIN EXPERIENCE ===== */
      .main-experience {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 50;
        display: none;
      }

      .main-experience.active {
        display: block;
      }

      .main-video-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      #mainVideo {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .main-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.4) 50%, rgba(0,0,0,0.8) 100%);
        transition: opacity 0.8s;
      }

      .main-overlay.fade {
        opacity: 0;
      }

      .play-content {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 2;
        transition: opacity 0.8s;
      }

      .play-content.hidden {
        opacity: 0;
        pointer-events: none;
      }

      .play-title {
        font-size: clamp(3rem, 10vw, 6rem);
        font-weight: 900;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        text-shadow: 0 0 40px rgba(139, 0, 0, 0.9);
        margin-bottom: 3rem;
      }

      .play-button {
        background: linear-gradient(135deg, #8B0000, #DC143C);
        border: 3px solid rgba(255, 255, 255, 0.4);
        color: #fff;
        font-size: 1.8rem;
        font-weight: 700;
        padding: 1.8rem 5rem;
        border-radius: 60px;
        cursor: pointer;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        transition: all 0.3s;
        box-shadow: 0 15px 50px rgba(139, 0, 0, 0.5);
      }

      .play-button:hover {
        transform: translateY(-8px);
        box-shadow: 0 20px 60px rgba(139, 0, 0, 0.7);
      }

      .controls-bar {
        position: fixed;
        bottom: -100px;
        left: 0;
        width: 100%;
        background: rgba(0, 0, 0, 0.85);
        backdrop-filter: blur(15px);
        padding: 1.5rem 2rem;
        z-index: 60;
        transition: bottom 0.4s;
        display: flex;
        gap: 1rem;
        justify-content: center;
      }

      .controls-bar.visible {
        bottom: 0;
      }

      .control-btn {
        background: rgba(255, 255, 255, 0.15);
        border: 1px solid rgba(255, 255, 255, 0.3);
        color: #fff;
        padding: 0.9rem 1.8rem;
        border-radius: 30px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
      }

      .control-btn:hover {
        background: rgba(255, 255, 255, 0.25);
        transform: translateY(-3px);
      }

      /* Responsive */
      @media (max-width: 768px) {
        .landing-title, .play-title {
          font-size: clamp(2rem, 12vw, 4rem);
        }

        .begin-button, .play-button {
          font-size: 1.3rem;
          padding: 1.3rem 3.5rem;
        }

        .wizard-header {
          padding: 1.5rem 1.5rem 1rem;
        }

        .wizard-content {
          padding: 1rem 1.5rem 1.5rem;
        }

        .wizard-nav {
          padding: 1rem 1.5rem 1.5rem;
        }

        .step-title {
          font-size: 1.5rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- LANDING PAGE -->
    <div class="landing-page" id="landingPage">
      <div class="teaser-video-container">
        <video id="teaserVideo" autoplay loop muted playsinline>
          <source src="video/teaser1.mp4" type="video/mp4">
        </video>
      </div>
      <div class="teaser-overlay"></div>
      <div class="landing-content">
        <h1 class="landing-title">Haunted</h1>
        <button class="begin-button" id="beginBtn">Begin</button>
      </div>
    </div>

    <!-- WIZARD MODAL -->
    <div class="wizard-modal" id="wizardModal">
      <div class="wizard-container">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="wizard-header">
          <div class="step-counter" id="stepCounter">STEP 1 OF 7</div>
          <h2 class="step-title" id="stepTitle">Enable the Haunted Skill</h2>
        </div>

        <div class="wizard-content">
          <!-- Step 1 -->
          <div class="step active" data-step="1">
            <ul class="instruction-list">
              <li>Open your Alexa app</li>
              <li>Go to <strong>Skills & Games</strong></li>
              <li>Search for <strong>"Haunted"</strong></li>
              <li>Tap <strong>"Enable to Use"</strong></li>
            </ul>
          </div>

          <!-- Step 2 -->
          <div class="step" data-step="2">
            <div class="info-box">
              <strong>What is a Routine?</strong>
              A routine is simply: <strong>"When THIS happens → Do THAT"</strong>
              <div class="example">Example: When motion detected → Turn on lights</div>
            </div>
            <p style="margin-top: 1.5rem; line-height: 1.6; color: rgba(255, 255, 255, 0.85);">
              You'll create 3 simple routines to control your lights during the haunted experience.
            </p>
          </div>

          <!-- Step 3 -->
          <div class="step" data-step="3">
            <p style="margin-bottom: 1rem; color: rgba(255, 255, 255, 0.85);">
              After enabling the skill, open Alexa app → <strong>Devices tab</strong>
            </p>
            <p style="margin-bottom: 1.5rem; color: rgba(255, 255, 255, 0.85);">
              Look for these 3 new sensors:
            </p>
            <div class="sensor-grid">
              <div class="sensor-card">
                <div class="sensor-icon">⚫</div>
                <div class="sensor-name">Haunted off</div>
              </div>
              <div class="sensor-card">
                <div class="sensor-icon">⚪</div>
                <div class="sensor-name">Haunted on</div>
              </div>
              <div class="sensor-card">
                <div class="sensor-icon">🔴</div>
                <div class="sensor-name">Flash red</div>
              </div>
            </div>
          </div>

          <!-- Step 4 -->
          <div class="step" data-step="4">
            <p style="margin-bottom: 1.5rem; color: rgba(255, 255, 255, 0.85);">
              This routine turns your lights <strong>OFF</strong> during blackout scenes:
            </p>
            <ul class="instruction-list">
              <li>Tap on <strong>⚫ Haunted off</strong> sensor</li>
              <li>Tap <strong>"Create Routine"</strong></li>
              <li>When: <strong>Sensor detects</strong></li>
              <li>Add Action → Smart Home → <strong>Turn OFF lights</strong></li>
              <li>Select all lights (or choose specific ones)</li>
              <li>Save</li>
            </ul>
          </div>

          <!-- Step 5 -->
          <div class="step" data-step="5">
            <p style="margin-bottom: 1.5rem; color: rgba(255, 255, 255, 0.85);">
              This routine turns your lights back <strong>ON</strong>:
            </p>
            <ul class="instruction-list">
              <li>Tap on <strong>⚪ Haunted on</strong> sensor</li>
              <li>Tap <strong>"Create Routine"</strong></li>
              <li>When: <strong>Sensor detects</strong></li>
              <li>Add Action → Smart Home → <strong>Turn ON lights</strong></li>
              <li>Select all lights (or choose specific ones)</li>
              <li>Save</li>
            </ul>
          </div>

          <!-- Step 6 -->
          <div class="step" data-step="6">
            <p style="margin-bottom: 1.5rem; color: rgba(255, 255, 255, 0.85);">
              This routine creates a spooky <strong>RED flash</strong> effect:
            </p>
            <ul class="instruction-list">
              <li>Tap on <strong>🔴 Flash red</strong> sensor</li>
              <li>Tap <strong>"Create Routine"</strong></li>
              <li>When: <strong>Sensor detects</strong></li>
              <li>Add Action → Smart Home → Lights</li>
              <li>Select your lights</li>
              <li>Set Color to <strong>RED</strong></li>
              <li>Save</li>
            </ul>
          </div>

          <!-- Step 7 -->
          <div class="step" data-step="7">
            <div class="success-icon">🎃</div>
            <div class="success-message">
              <strong style="font-size: 1.3rem; display: block; margin-bottom: 1rem;">You're All Set!</strong>
              Your lights are now synced to the haunted experience.<br><br>
              Get ready for a spooky show! 👻
            </div>
          </div>
        </div>

        <div class="wizard-nav">
          <button class="nav-btn btn-back" id="btnBack" disabled>← Back</button>
          <button class="nav-btn btn-next" id="btnNext">Next →</button>
        </div>
      </div>
    </div>

    <!-- MAIN EXPERIENCE -->
    <div class="main-experience" id="mainExperience">
      <div class="main-video-container">
        <video id="mainVideo" muted playsinline>
          <source src="https://pub-2de09b707e4344709b4b5a179e9e4a88.r2.dev/film.mp4" type="video/mp4">
        </video>
      </div>
      <div class="main-overlay" id="mainOverlay"></div>
      <div class="play-content" id="playContent">
        <h1 class="play-title">Haunted</h1>
        <button class="play-button" id="playBtn">Play</button>
      </div>
      <div class="controls-bar" id="controlsBar">
        <button class="control-btn" id="restartBtn">↻ Restart</button>
        <button class="control-btn" id="unmuteBtn">🔊 Unmute</button>
      </div>
    </div>

    <script>
      // Elements
      const landingPage = document.getElementById('landingPage');
      const beginBtn = document.getElementById('beginBtn');
      const wizardModal = document.getElementById('wizardModal');
      const mainExperience = document.getElementById('mainExperience');
      const mainVideo = document.getElementById('mainVideo');
      const playBtn = document.getElementById('playBtn');
      const playContent = document.getElementById('playContent');
      const mainOverlay = document.getElementById('mainOverlay');
      const controlsBar = document.getElementById('controlsBar');
      const restartBtn = document.getElementById('restartBtn');
      const unmuteBtn = document.getElementById('unmuteBtn');

      // Wizard elements
      const progressFill = document.getElementById('progressFill');
      const stepCounter = document.getElementById('stepCounter');
      const stepTitle = document.getElementById('stepTitle');
      const btnBack = document.getElementById('btnBack');
      const btnNext = document.getElementById('btnNext');

      let currentStep = 1;
      const totalSteps = 7;

      const stepTitles = [
        "Enable the Haunted Skill",
        "Understanding Alexa Routines",
        "Locate Your 3 Sensors",
        "Set Up Blackout Effect",
        "Set Up Lights On",
        "Set Up Red Flash Effect",
        "You're All Set! 🎃"
      ];

      // Begin button - open wizard
      beginBtn.addEventListener('click', () => {
        wizardModal.classList.add('active');
      });

      // Wizard navigation
      function updateStep() {
        const progress = (currentStep / totalSteps) * 100;
        progressFill.style.width = progress + '%';
        
        stepCounter.textContent = `STEP ${currentStep} OF ${totalSteps}`;
        stepTitle.textContent = stepTitles[currentStep - 1];
        
        document.querySelectorAll('.step').forEach(step => {
          step.classList.remove('active');
        });
        document.querySelector(`[data-step="${currentStep}"]`).classList.add('active');
        
        btnBack.disabled = currentStep === 1;
        
        if (currentStep === totalSteps) {
          btnNext.textContent = 'Complete Setup ✓';
          btnNext.classList.add('btn-complete');
        } else {
          btnNext.textContent = 'Next →';
          btnNext.classList.remove('btn-complete');
        }
      }

      btnNext.addEventListener('click', () => {
        if (currentStep < totalSteps) {
          currentStep++;
          updateStep();
        } else {
          // Complete wizard - show main experience
          wizardModal.classList.remove('active');
          landingPage.classList.add('hidden');
          mainExperience.classList.add('active');
        }
      });

      btnBack.addEventListener('click', () => {
        if (currentStep > 1) {
          currentStep--;
          updateStep();
        }
      });

      // Play button - start main video
      playBtn.addEventListener('click', () => {
        playContent.classList.add('hidden');
        mainOverlay.classList.add('fade');
        
        setTimeout(() => {
          mainVideo.muted = false;
          mainVideo.currentTime = 0;
          mainVideo.play();
          controlsBar.classList.add('visible');
        }, 400);
      });

      // Restart button
      restartBtn.addEventListener('click', () => {
        mainVideo.currentTime = 0;
        mainVideo.play();
      });

      // Unmute button
      unmuteBtn.addEventListener('click', () => {
        mainVideo.muted = false;
        mainVideo.volume = 1.0;
        unmuteBtn.textContent = '🔊 Unmuted';
      });

      // Video ended
      mainVideo.addEventListener('ended', () => {
        playContent.classList.remove('hidden');
        mainOverlay.classList.remove('fade');
        playBtn.textContent = 'Watch Again';
        controlsBar.classList.remove('visible');
      });

      // Auto-hide controls
      let hideControlsTimeout;
      document.addEventListener('mousemove', () => {
        if (!mainVideo.paused) {
          controlsBar.classList.add('visible');
          clearTimeout(hideControlsTimeout);
          hideControlsTimeout = setTimeout(() => {
            controlsBar.classList.remove('visible');
          }, 3000);
        }
      });

      // Initialize
      updateStep();
    </script>
    
    <!-- Include your app.js for cue points -->
    <script src="/app.js"></script>
  </body>
</html>